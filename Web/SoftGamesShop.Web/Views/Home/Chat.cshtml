
@{
    this.ViewBag.Title = "Chat";
}

@*<h1>@this.ViewBag.Title</h1>*@
<head>
    <style>
        body {
            background-image: url('https://cdn.wallpapersafari.com/82/19/F9ielj.jpg');
        }
    </style>
</head>
<style>
div.panel-body { overflow: auto; background: url('https://1stwebdesigner.com/wp-content/uploads/2019/07/css-background-effects-thumb.jpg'); }
</style>
<h2>Game Chat <i class="fa fa-paper-plane fa-fw"></i></h2>

    <!-- /.panel-heading -->
    <div class="panel-body" id="messagesList" style="height:250px;">
        <input type="hidden" id="displayname" />

        <p id="discussion"></p>
    </div>
    <!-- /.panel-body -->
    <div class="panel-footer">
        <div class="input-group">
            <input id="messageInput" type="text" name="message" class="form-control input-sm" placeholder="Type your message here..." />

            <span class="input-group-btn">
                <input type="button" class="btn btn-warning btn-sm" id="sendButton" value="Send">

            </span>
        </div>
    </div>
</div>
<!--<div class="container">
    <div id="message-holder" class="mt-3 d-flex justify-content-start">
        <h4>Message</h4>
        <input class="w-75 ml-4 pl-3" type="text" id="messageInput" placeholder="Message..." />
        <button id="sendButton" class="ml-4 btn btn-dark btn-lg">Send</button>
    </div>
    <hr style="height: 5px;" class="bg-dark" />
    <div id="messagesList" style="font-size: 28px;">
    </div>
</div>-->
@*<div class="bg-primary" style="text-align:right;"></div>*@

@section Scripts {
    <script>
        var connection =
            new signalR.HubConnectionBuilder()
                .withUrl("/chat")
                .build();
        connection.on("NewMessage",
            function (message) {
                var chatInfo = `<div  style="color:white;text-align:center;font-size: 28px">[${message.user}] ${escapeHtml(message.text)}</div>`;
                $("#messagesList").append(chatInfo);
            });
         
           
        $("#sendButton").click(function () {
            var message = $("#messageInput").val();
            connection.invoke("Send", message);
            $("#messageInput").val("");
        });
        connection.start().catch(function (err) {
            return console.error(err.toString());
        });
        function escapeHtml(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }
    </script>
}